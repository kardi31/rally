<script>
    $(document).ready(function(){
        var grid = new Datatable();
            grid.init({
                src: $("#datatable_ajax"),
                dataTable: {   
                "aoColumns": [
                        { sWidth: '5%' },
                        { sWidth: '15%' },
                        { sWidth: '20%' },
                        { sWidth: '20%' },
                        { sWidth: '20%' },
                        { sWidth: '10%' },
                        { "bSortable": false, sWidth: '15%' }
                    ],
                    "aLengthMenu": [
                        [20, 50, 100, 150, -1],
                        [20, 50, 100, 150, "All"] // change per page values here
                    ],
                    "iDisplayLength": 20, // default record count per page
                    "bServerSide": true, // server side processing
                    "sAjaxSource": "/admin/rally/show-rally-result-data/id/<?php echo $rally['id']; ?>", // ajax source
                    "aaSorting": [[ 3, "asc" ]] // set first column as a default sort by asc
                }
            });
               grid.getDataTable().yadcf([
                    {
                      column_number: 1,
                      filter_type: "text"
                    },
                    {
                      column_number: 2,
                      filter_type: "text"
                    },
                    {
                      column_number: 3,
                      filter_type: "text"
                    },
                    {
                        column_number: 4,
                        data: [{
                            value: '1',
                            label: 'Out of race'
                        }, {
                            value: '0',
                            label: 'In rance'
                        }],
                    }
        
        ]);
                
        customDataTableFunctions();
    });
</script>
<div class="row">
    <div class="col-md-12">
        <h3 class="page-title">
        Rally result <?php echo $rally['name']; ?>
        </h3>
        <ul class="page-breadcrumb breadcrumb">
                <li>
                        <i class="fa fa-home"></i>
                        <a href="/admin">
                        Home </a>
                        <i class="fa fa-angle-right"></i>
                </li>
                <li>
                        <a href="/admin/rally/list-rally">
                        List rally </a>
                        <i class="fa fa-angle-right"></i>
                </li>
                <li>
                        <a href="#">Rally result</a>
                </li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="portlet blue box">
                <div class="portlet-title">
                        <div class="caption">
                                <i class="fa fa-shopping-cart"></i>Rally result <?php echo $rally['name']; ?>
                        </div>
                </div>
                <div class="portlet-body">
                        <div class="table-container">
                                <table class="table table-striped table-bordered table-hover" id="datatable_ajax">
                                    <thead>
                                        <tr role="row" class="heading">
                                                <th>
                                                        <input type="checkbox" class="group-checkable">
                                                </th>
                                                <th>Id</th>
                                                <th>Team</th>
                                                <th>Total time</th>
                                                <th>Out of race</th>
                                                <th>Stage out</th>
                                                <th>Options</th>
                                        </tr>
                                        <tr role="row" class="filter">
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th></th>
                                            <th>
                                                <div class="margin-bottom-5">
                                                        <button class="btn btn-sm yellow filter-submit margin-bottom"><i class="fa fa-search"></i> Search</button>
                                                </div>
                                                <button class="btn btn-sm red filter-cancel"><i class="fa fa-times"></i> Reset</button>

                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                        </div>
                </div>
        </div>
        <?php foreach($rally['Stages'] as $stage): ?>
            <script>
        $(document).ready(function(){
            var grid<?= $stage['id']; ?> = new Datatable();
                grid<?= $stage['id']; ?>.init({
                    src: $("#datatable_ajax<?= $stage['id']; ?>"),
                    dataTable: {   
                    "aoColumns": [
                            { sWidth: '2%' },
                            { sWidth: '2%' },
                            { sWidth: '15%' },
                            { sWidth: '10%' },
                            { sWidth: '10%' },
                            { sWidth: '10%' },
                            { sWidth: '13%' },
                            { sWidth: '10%' },
                            { sWidth: '10%' },
                            { sWidth: '2%' },
                            { "bSortable": false, sWidth: '10%' }
                        ],
                        "aLengthMenu": [
                            [20, 50, 100, 150, -1],
                            [20, 50, 100, 150, "All"] // change per page values here
                        ],
                        "iDisplayLength": 20, // default record count per page
                        "bServerSide": true, // server side processing
                        "sAjaxSource": "/admin/rally/show-stage-result-data/stage-id/<?= $stage['id']; ?>", // ajax source
                        "aaSorting": [[ 3, "asc" ]] // set first column as a default sort by asc
                    }
                });
                   grid<?= $stage['id']; ?>.getDataTable().yadcf([
                        {
                          column_number: 1,
                          filter_type: "text"
                        },
                        {
                          column_number: 2,
                          filter_type: "text"
                        },
                        {
                          column_number: 3,
                          filter_type: "text"
                        },
                        {
                          column_number: 4,
                          filter_type: "text"
                        },
                        {
                          column_number: 5
                        },
                        {
                          column_number: 6,
                          filter_type: "text"
                        },
                        {
                          column_number: 7,
                          filter_type: "text"
                        },
                        {
                          column_number: 8,
                          filter_type: "text"
                        },
                        {
                            column_number: 9,
                            data: [{
                                value: '0',
                                label: 'W wyścigu'
                            },
                            {
                                value: '1',
                                label: 'Poza wyścigiem'
                            }]
                        }

            ]);

//            customDataTableFunctions();
        });
    </script>
            <div class='col-md-6'>
        <div class="row">
            <div class="col-md-12">
                <div class="portlet">
                    <div class="portlet-title">
                            <div class="caption">
                                    <i class="fa fa-shopping-cart"></i>Wyniki etapu <?php echo $stage['name']; ?> - <?php echo $stage['Rally']['name']; ?>
                            </div>
                    </div>
                    <div class="portlet-body">
                            <div class="table-container">
                                    <table class="table table-striped table-bordered table-hover" id="datatable_ajax<?= $stage['id']; ?>">
                                    <thead>
                                    <tr role="row" class="heading">
                                            <th>
                                                    <input type="checkbox" class="group-checkable">
                                            </th>
                                            <th>Id</th>
                                            <th>Team</th>
                                            <th>Time</th>
                                            <th>Accident</th>
                                            <th>Risk</th>
                                            <th>Options</th>
                                    </tr>
                                    <tr role="row" class="filter">
                                            <th>
                                            </th>
                                            <th>
                                            </th>
                                            <th>
                                            </th>
                                            <th>
                                            </th>
                                            <th>	
                                            </th>
                                            <th>	
                                            </th>
                                            <th>	
                                            </th>
                                            <th>	
                                            </th>
                                            <th>	
                                            </th>
                                            <th>	
                                            </th>
                                            <th>
                                                <div class="margin-bottom-5">
                                                        <button class="btn btn-sm yellow filter-submit margin-bottom"><i class="fa fa-search"></i> Search</button>
                                                </div>
                                                <button class="btn btn-sm red filter-cancel"><i class="fa fa-times"></i> Reset</button>

                                            </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                    </table>
                            </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        <?php endforeach; ?>
    </div>
</div>